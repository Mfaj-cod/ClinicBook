{% extends 'base.html' %}
{% block content %}
<div class="container my-4">
  <div class="text-center mb-4">
    <span class="d-inline-block rounded-circle bg-primary bg-opacity-10 p-3">
      <i class="bi bi-person-badge" style="font-size:2.2rem; color:#0d6efd;"></i>
    </span>
    <h2 class="fw-bold mt-2" style="color:#0d3a6f;">Find a Doctor</h2>
    <div class="text-muted mb-2" style="font-size:1.1rem;">Browse and book appointments with top doctors</div>
  </div>

  <div class="mx-auto" style="max-width: 700px;">
    <form class="row g-2 align-items-end bg-white rounded shadow-sm p-3 mb-4" method="get" action="{{ url_for('doctors') }}">
      <div class="col-12 col-md-5">
        <label class="form-label mb-1 small text-muted">Search</label>
        <input type="text" class="form-control" name="q"
               placeholder="Name, specialization, or clinic"
               value="{{ q }}">
      </div>
      <div class="col-6 col-md-3">
        <label class="form-label mb-1 small text-muted">City</label>
        <input type="text" class="form-control" name="city"
               placeholder="City" value="{{ city }}">
      </div>
      <div class="col-6 col-md-3">
        <label class="form-label mb-1 small text-muted">Specialization</label>
        <select class="form-select" name="specialization">
          <option value="">All Specializations</option>
          <option value="Cardiologist" {% if specialization=='Cardiologist' %}selected{% endif %}>Cardiologist</option>
          <option value="Dermatologist" {% if specialization=='Dermatologist' %}selected{% endif %}>Dermatologist</option>
          <option value="Neurologist" {% if specialization=='Neurologist' %}selected{% endif %}>Neurologist</option>
          <option value="Psychiatrist" {% if specialization=='Psychiatrist' %}selected{% endif %}>Psychiatrist</option>
          <option value="General Physician" {% if specialization=='General Physician' %}selected{% endif %}>General Physician</option>
          <option value="Endocrinologist" {% if specialization=='Endocrinologist' %}selected{% endif %}>Endocrinologist</option>
        </select>
      </div>
      <div class="col-12 col-md-1 d-grid">
        <button type="submit" class="btn btn-primary">
          <i class="bi bi-search"></i>
        </button>
      </div>
    </form>
  </div>

  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
    {% for doctor in doctors %}
    <div class="col">
      <div class="card h-100 border-0 shadow-sm doctor-card">
        <div class="card-body d-flex flex-column">
          <div class="d-flex align-items-center mb-2">
            <span class="rounded-circle bg-primary bg-opacity-10 d-flex align-items-center justify-content-center" style="width:48px; height:48px;">
              <i class="bi bi-person-circle" style="font-size:2rem; color:#0d6efd;"></i>
            </span>
            <div class="ms-3">
              <h5 class="card-title mb-0 fw-semibold" style="color:#0d3a6f;">{{ doctor.name }}</h5>
              <div class="text-muted small">{{ doctor.specialization }}</div>
            </div>
          </div>
          <div class="mb-1 small text-muted">
            <i class="bi bi-hospital"></i> {{ doctor.clinic_name }}, {{ doctor.clinic_city }}
          </div>
          <div class="mb-1 small text-muted">
            <i class="bi bi-geo-alt"></i> {{ doctor.address }}
          </div>
          <div class="mb-1 small text-muted">
            <i class="bi bi-currency-rupee"></i> {{ doctor.fees }}
          </div>
          {% if doctor.about %}
          <div class="mb-2 small text-secondary" style="min-height:2.2em;">{{ doctor.about }}</div>
          {% else %}
          <div class="mb-2 small text-secondary" style="min-height:2.2em;">&nbsp;</div>
          {% endif %}
          <div class="mt-auto">
            <a href="{{ url_for('doctor_detail', doc_id=doctor.id) }}"
               class="btn btn-outline-primary btn-sm w-100">
               <i class="bi bi-calendar-plus"></i> Book Appointment
            </a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  {% if doctors|length == 0 %}
  <div class="alert alert-warning text-center mt-4 shadow-sm">
    <i class="bi bi-emoji-frown"></i> No doctors found matching your criteria.
  </div>
  {% endif %}
</div>
{% endblock %}
