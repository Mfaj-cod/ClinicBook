{% extends "base.html" %}
{% block content %}
<div class="container mt-4">

  {# -------- Case 1: Doctor Detail with available slots -------- #}
  {% if doc %}
  <div class="card shadow-sm">
    <div class="card-body text-center">
      <h3 class="card-title text-primary">
        <i class="bi bi-person-badge"></i> {{ doc.name }}
      </h3>
      <p class="text-muted"><i class="bi bi-hospital"></i> {{ doc.clinic_name }}</p>
      <p><i class="bi bi-geo-alt"></i> {{ doc.address }}, {{ doc.clinic_city }}</p>
      <p><strong>Fees:</strong> ₹{{ doc.fees }}</p>

      <h4 class="mt-4">Available Slots</h4>
      {% if slots and slots|length > 0 %}
        <ul class="list-group">
          {% for s in slots %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <span><i class="bi bi-clock"></i> {{ s.date }} {{ s.time }}</span>
            <span>
              {% if s.booked_count < s.capacity %}
                <a href="{{ url_for('book', slot_id=s.id) }}" class="btn btn-sm btn-success">
                  Book
                </a>
              {% else %}
                <span class="badge bg-danger">Full</span>
              {% endif %}
            </span>
          </li>
          {% endfor %}
        </ul>
      {% else %}
        <div class="alert alert-secondary mt-3">
          <i class="bi bi-calendar-x"></i> No slots available.
        </div>
      {% endif %}
    </div>
  </div>
  {% endif %}


  {# -------- Case 2: Booking a specific slot -------- #}
  {% if slot %}
  <div class="card shadow-sm mt-4">
    <div class="card-body">
      <h3 class="card-title text-primary">
        Book Appointment - {{ slot.doctor_name }}
      </h3>
      <p><i class="bi bi-hospital"></i> {{ slot.clinic_name }}</p>
      <p><strong>Fees:</strong> ₹{{ slot.fees }}</p>
      <p><strong>Slot:</strong> {{ slot.date }} {{ slot.time }}</p>

      <form method="POST">
        <div class="mb-3">
          <label class="form-label">Patient Name</label>
          <input type="text" class="form-control" name="patient_name" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Patient Phone</label>
          <input type="text" class="form-control" name="patient_phone" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Symptoms</label>
          <textarea class="form-control" name="symptoms"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Confirm Booking</button>
      </form>
    </div>
  </div>
  {% endif %}

</div>
{% endblock %}
